<div class="container border p-5">
  <div class="mb-3 p-0"
       *ngIf="isLoggedIn && loginUser.id == post.author.id"
  >
    <ul class="nav">
      <li class="nav-item">
        <a class="nav-link link-primary link-styled px-0"
           [routerLink]="['/blog/edit', post.id]"
        >Edit</a>
      </li>
      <li class="nav-item">
        <a class="nav-link link-primary link-styled"
           routerLink=""
           (click)="deleteBlog()"
        >Delete</a>
      </li>
    </ul>
  </div>
  <h1 class="fw-bold fs-2">{{ post.title }}</h1>
  <p class="fs-6 text-secondary">By
    <a class="link-primary link-styled"
       [routerLink]="['/account/profile', post.author.userprofile.id]"
    >{{ post.author.username }}
    </a>
    on {{ post.published_at }}
  </p>

  <div class="content-body mt-5 mb-5">
    <div [innerHtml]="sanitizer.bypassSecurityTrustHtml(post.content_body)"></div>
  </div>

  <hr>
  <h2>Comment</h2>
  <div class="comment">
    <div class="add-comment">
      <form class="form-group mb-5 text-end"
            *ngIf="isLoggedIn"
            (ngSubmit)="createComment()"
      >
      <textarea
        class="form-control mb-3"
        name="comment"
        type="text"
        placeholder="Leave a comment here ..."
        required="required"
        [(ngModel)]="commentForm.comment">
      </textarea>
        <button class="btn btn-sm btn-primary">Add Comment</button>
      </form>

      <div class="border bg-light p-5 mb-5 text-center"
           *ngIf="!isLoggedIn"
      >
        <p class="fw-bold">Please Login To Add Comments</p>
        <button class="btn btn-primary"
                (click)="onLogin()"
        >Login</button>
      </div>
    </div>

    <ul class="list-unstyled">
      <li class="mb-3" *ngFor="let comment of comments">
        <div class="row">
          <div class="col-md-12">
            <div class="card border-0">
              <div class="d-flex flex-row comment-row align-items-start">
                <div class="avatar">
                  <img class="rounded-circle" src="{{ comment.user.userprofile.avatar}}" alt="user">
                </div>
                <div class="comment-text mx-3">
                  <p class="card-title mb-1">
                    <a class="link-styled"
                       [routerLink]="['/account/profile', comment.user.userprofile.id]"
                    >{{ comment.user.username }}</a>
                  </p>
                  <div class="comment-footer text-secondary mb-2">
                    <span class="date">{{ comment.created_at | date:'MMM d, y, h:mm a' }}</span>
                  </div>

                  <p>{{ comment.comment }}</p>

                  <a class="link-styled text-secondary mt-3"
                     routerLink=""
                     *ngIf="isLoggedIn && loginUser.id == comment.user.id"
                     (click)="deleteComment(comment.id)"
                  >delete</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>


<div class="card p-3">
  <h1 class="card-title mb-4 mt-1">Register</h1>
  <form name="form"
        *ngIf="!isSuccessful"
        (ngSubmit)="f.form.valid && onRegister()"
        #f="ngForm"
        novalidate
  >

    <div class="form-group mb-3">
      <label>Username</label>
      <input name="username" class="form-control" type="text"
             [(ngModel)]="form.username"
             required
             minlength="3"
             maxlength="20"
             #username="ngModel"
      >
      <div id="username_error" class="form-text alert-danger" *ngIf="f.submitted && username.invalid">
        <div *ngIf="username.errors?.required">Username is required</div>
        <div *ngIf="username.errors?.minlength">Username must be at least 3 characters</div>
        <div *ngIf="username.errors?.maxlength">Username must be at most 20 characters</div>
      </div>
    </div>

    <div class="form-group mb-3">
      <label>Email</label>
      <input name="email" class="form-control" type="email"
             [(ngModel)]="form.email"
             required
             email
             #email="ngModel"
      >
      <div id="email_error" class="form-text alert-danger" *ngIf="f.submitted && email.invalid">
        <div *ngIf="email.errors?.required">Email is required</div>
        <div *ngIf="email.errors?.email">Email must be a valid email address</div>
      </div>
    </div>

    <div class="form-group mb-3">
      <label>Password</label>
      <input name="password" class="form-control" type="password"
             [(ngModel)]="form.password"
             required
             minlength="6"
             #password="ngModel"
      >
      <div id="password_error" class="form-text alert-danger" *ngIf="(f.submitted || password.touched) && password.invalid">
        <div *ngIf="password.errors?.required">Password is required</div>
        <div *ngIf="password.errors?.minlength">Password must be at least 6 characters</div>
      </div>
    </div>

    <div class="form-group mb-3">
      <label>Password Confirmation</label>
      <input name="password2" class="form-control" type="password"
             [(ngModel)]="form.password2"
             #password2="ngModel"
             required
             pattern="{{ password.value }}"
      >
      <div id="password2_error" class="form-text alert-danger" *ngIf="(f.submitted || password2.touched) && password2.invalid">
        <div *ngIf="password2.errors?.required">Enter your password again to confirm</div>
        <div *ngIf="password2.errors?.pattern">Password does not match</div>
      </div>
    </div>

    <button type="submit" class="btn btn-primary mb-3">Register</button>

    <div class="form-group">
      <div
        class="alert alert-danger"
        role="alert"
        *ngIf="f.submitted && isRegiaterFailed"
      >
        Register failed: {{ errorMessage }}
      </div>
      <div
        class="alert alert-danger"
        role="alert"
        *ngIf="f.submitted && isSuccessful"
      >
        <p>Register successfully! Go to<a href="account/login" class="link-styled">Login</a></p>
      </div>

    </div>
  </form>

  <p>Already have an account? <a href="account/login" class="link-styled float-right">Login</a></p>
</div>
